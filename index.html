<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<link rel = 'stylesheet' href = 'https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/css/materialize.min.css'>
<script src = 'https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/js/materialize.min.js'></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=DM+Serif+Text&display=swap" rel="stylesheet">

<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Text&display=swap" rel="stylesheet">

<style>
    
</style>

<head><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=yes" />
    <meta charset="utf-8">

    <title>Nathan Yan</title>
    <meta name="description" content="Nathan Yan's got a personal website!">
    <meta name="author" content="Nathan Yan">
    <meta name = "keywords" content= "Nathan Yan, Nathan, Yan, Christopher, Nathan Christopher Yan">

  
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <link rel="manifest" href="./site.webmanifest">

    <link rel = 'stylesheet' type = 'text/css' href = './style.css'>
</head>

<html style = 'width: 100%; height: 100%'>
    <body style = 'width: 100%; height: 100%'>
        <div style = 'height: fit-content; min-height: 100%; display:flex; align-items: center; padding: 50px; background: white' id = 'intro'>
            <div class = 'text-block' >
                <h3>Hello!</h3>
                <p style = 'margin-top: -15px; color: #2222ff; font-weight: 400'><a ref = "assets/resume.pdf" href = 'assets/resume.pdf' class = 'olink'>résumé</a> · <a ref = "mailto:nathancy@uw.edu" href = 'mailto:nathancy@uw.edu' class = 'olink'>nathancy@uw.edu</a></p>
                <p>My name is <span style = 'font-weight: 500'>Nathan Yan</span>. I am an incoming freshman at the <a class = 'olink' href = 'https://cs.washington.edu' ref = 'cs.washington.edu'>Paul G. Allen School</a> at the <a href = 'https://washington.edu'><span class = 'olink link' ref = 'washington.edu' style = 'color: #4b2e83; font-weight: 500'>University of Washington</span></a>.</p>
                <p>I love all things computer science, but I have a particular interest in artificial intelligence, especially in fields like deep reinforcement learning and computer vision.</p>
                <p>Take a look at some of the things I've worked on over the years! ⬇️</p>
            </div>

            <div id = 'cart'></div>
            <div id = 'pole'></div>
        </div>

        <div style = 'padding-bottom: 100px; margin-top: 100px;'>
            <div class = 'text-block'>
                <h3>Projects.</h3>
                <p>These are some things I've worked on, either because a neat idea caught my attention or I had a problem I wanted to solve.</p>
            </div>
            <div id = 'projects' style = 'position: relative; height: fit-content; display: flex; flex-wrap: wrap; padding: 50px; justify-content: center;'>
                
                <div class = 'project' style = 'top: 10px; left: 20px; margin-right: 150px'>
                    <a href = 'https://github.com/nathan-yan/mnist-neural-automata'><img class = 'olink image' ref = 'nathan-yan/mnist-neural-automata' src = 'https://github.com/nathan-yan/mnist-neural-automata/raw/master/mnist.gif'></a>
                    <div class = 'text'>Growing MNIST digits with neural cellular automata</div>
                </div>

                <div class = 'project' style = 'top: 30px; left: 10px; margin-right: 150px'>
                    <a href = 'https://github.com/nathan-yan/fractals'><img class = 'olink image' ref = 'nathan-yan/fractals' src = 'https://nathan-yan.github.io/fractals/fractals/fractal16_.png'></a>
                    <div class = 'text text-center'>Generating fractals with complex "neural networks" <a href = 'https://nathan-yan.github.io/fractals' class = 'olink' ref = 'nathan-yan.github.io/fractals'>Blog post</a></div>
                </div>

                <div class = 'project' style = 'top: -15px; left: 15px;'>
                    <a href = 'https://github.com/team-llambda/gradebook-backend'><img class = 'olink image' ref = 'team-llambda/gradebook-backend' src = './assets/gradebook.png'></a>
                    <div class = 'text text-left'><span  style = 'font-weight: 500'>GradeBook</span>, an intuitive grade viewer</div>
                </div>

                <div class = 'project' style = 'top: -15px; left: 15px; margin-right: 150px'>
                    <a href = 'https://github.com/nathan-yan/otp_'><img class = 'olink image' ref = 'nathan-yan/otp_' src = './assets/demo_otp.gif'></a>
                    <div class = 'text'><span style = 'font-weight: 500'>otp_</span>, a commandline one-time password interface
                    </div>
                </div>

                <div class = 'project' style = 'top: -15px; left: 15px; margin-right: 150px'>
                    <a href = 'https://github.com/nathan-yan/poly'><img class = 'olink image' ref = 'nathan-yan/poly' src = './assets/poly.gif'></a>
                    <div class = 'text text-center'><span style = 'font-weight: 500'>poly</span>, an 8bit multiplayer platformer (WIP!)
                    </div>
                </div>

                <div class = 'project' style = 'top: -15px; left: 15px;'>
                    <a href = 'https://github.com/nathan-yan/wells'><img class = 'olink image' ref = 'nathan-yan/wells' src = './assets/wells.gif'></a>
                    <div class = 'text text-left'><span style = 'font-weight: 500'>Wells</span>, an illustration of various gradient descent methods</div>
                </div>

            </div>

            <div class = 'text-block' style = 'margin-top: 100px'>
                <h3>Models.</h3>
                <p>These are implementations of papers I found especially cool.</p>
            </div>
            <div id = 'models' style = 'position: relative; height: fit-content; display: flex; flex-wrap: wrap; padding: 50px; justify-content: center;'>
                <div class = 'model' style = 'top: 10px; left: 20px; margin-right: 150px'>
                    <a href = 'https://github.com/nathan-yan/neural-turingmachine'><img class = 'olink image' ref = 'nathan-yan/neural-turingmachine' src = './assets/ntm.PNG'></a>
                    <div class = 'text'>Neural Turing Machines [Graves et al.,2014]</div>
                </div>

                <div class = 'model' style = 'top: 10px; left: 20px; margin-right: 150px'>
                    <a href = 'https://github.com/nathan-yan/recurrent-attention-models'><img class = 'olink image' ref = 'nathan-yan/recurrent-attention-models' src = './assets/visual-attention.PNG'></a>
                    <div class = 'text text-center'>Recurrent Models of Visual Attention [Mnih et al.,2014]</div>
                </div>

                <div class = 'model' style = 'top: 10px; left: 20px; margin-right: 0px'>
                    <a href = 'https://github.com/nathan-yan/draw'><img class = 'olink image' ref = 'nathan-yan/draw' src = './assets/draw.gif'></a>
                    <div class = 'text text-left'>Deep Recurrent Attentive Writer [Gregor et al.,2015]</div>
                </div>

                <div class = 'model' style = 'top: 10px; left: 20px; margin-right: 150px;'>
                    <a href = 'https://github.com/nathan-yan/DQN'><img class = 'olink image' ref = 'nathan-yan/DQN' src = 'https://miro.medium.com/max/640/1*jXpSVhjWRxgzDDKKVAQR8A.gif
                    '></a>
                    <div class = 'text'>Deep Q Networks [Mnih et al.,2013]</div>
                </div>

                <div class = 'model' style = 'top: 10px; left: 20px; margin-right: 0px'>
                    <a href = 'https://github.com/nathan-yan/sketch-rnn'><img class = 'olink image' ref = 'nathan-yan/sketch-rnn' src = 'https://magenta.tensorflow.org/assets/sketch_rnn_demo/img/sketch_garden.gif
                    '></a>
                    <div class = 'text text-left'>Sketch-RNN [Ha & Eck,2017]</div>
                </div>


            </div>
        </div>

        <div style = 'margin-top: 100px; text-align: center; margin-bottom: 50px; width: 75%; margin-left: 12.5%'>
        Nathan Yan :: <a ref = "assets/resume.pdf" href = 'assets/resume.pdf' class = 'olink'>résumé</a> · <a ref = "mailto:nathancy@uw.edu" href = 'mailto:nathancy@uw.edu' class = 'olink'>nathancy[at]uw[dot]edu</a> · <a ref = "github.com/nathan-yan" href = 'https://github.com/nathan-yan' class = 'olink'>github</a></div>

        <div id = 'link-block'></div>


    </body>
</html>

<script>
    let handleEntities = (entities, n) => {
        entities.map((idx, ent) => {
        ent = $(ent);
        if (idx % n == 0){
            if (n == 1){ 
                ent.find('.text')[0].className = 'text text-center';
                ent.css('margin-right', '0px');
            }else{
                ent.find('.text')[0].className = 'text text-right';
                ent.css('margin-right', '150px');
            }
        }else if (idx % n == 1){
            if (n == 2){
                ent.find('.text')[0].className = 'text text-left';
                ent.css('margin-right', '0px');
            }else{
                ent.find('.text')[0].className = 'text text-center';
                ent.css('margin-right', '150px');    
            }
        }else if (idx % 3 == 2){
            ent.find('.text')[0].className = 'text text-left';
            ent.css('margin-right', '0px');
        }
    })

        if (n == 2 && entities.length % 2) {
            $(entities[entities.length - 1]).find('.text')[0].className = 'text text-center';
            $(entities[entities.length - 1]).css('margin-right', '0px');
        }

        else if (n == 3 && entities.length % 3 == 1) {
            $(entities[entities.length - 1]).find('.text')[0].className = 'text text-center';
            $(entities[entities.length - 1]).css('margin-right', '0px');
        }else if (n == 3 && entities.length % 3 == 2) {
            $(entities[entities.length - 1]).find('.text')[0].className = 'text text-left';
                
            $(entities[entities.length - 1]).css('margin-right', '0px');
        }

    }

    let checkSize = (e) => {
        let width = $(window).width();

        if (width > 1310) {
            $('#projects').css('padding-left', (50 + (width - 1310) / 2) + 'px');
            $('#projects').css('padding-right', (50 + (width - 1310) / 2) + 'px');

            $('#models').css('padding-left', (50 + (width - 1310) / 2) + 'px');
            $('#models').css('padding-right', (50 + (width - 1310) / 2) + 'px');

            let entities = $('.project');
            handleEntities(entities, 3);

            entities = $('.model');
            handleEntities(entities, 3);

            
            
        }else if (width > 802) {
            $('#projects').css('padding-left', (50 + (width - 910) / 2) + 'px');
            $('#projects').css('padding-right', (50 + (width - 910) / 2) + 'px');

            $('#models').css('padding-left', (50 + (width - 910) / 2) + 'px');
            $('#models').css('padding-right', (50 + (width - 910) / 2) + 'px');
            
            let entities = $('.project');
            handleEntities(entities, 2);

            entities = $('.model');
            handleEntities(entities, 2);

        }else {
            let entities = $('.project');
             handleEntities(entities, 1);

             entities = $('.model');
             handleEntities(entities, 1);
        }
    }

    $(document).ready(checkSize);

    $(window).resize(checkSize)
</script>

<script src = "./weights.js"></script>

<script>
    /*this code is heavily borrowed from the cartpole environment of OpenAI's gym*/
    $(document).mousemove((e) => {
     
        let width = $(window).width();
        let pos = e.clientX;

        let scaledPos = (e.clientX - width / 2) / (width / 2) * 3;
        targetTarget = scaledPos; 
    
        let target = $(e.target);
        if (target.hasClass("olink")) {
            let linkBlock = $('#link-block');
            linkBlock.css('top', (e.clientY  - 45) + 'px');
            linkBlock.css('left', (e.clientX + 8) + 'px');

            linkBlock.text(target.attr('ref'))
        }else{
            let linkBlock = $('#link-block');
            linkBlock.css('top', '-100px');
        }
    });

    let state = [
        (Math.random() - 0.5) * 2 * 2.,
        (Math.random() - 0.5) / 10. * 1,
        (Math.random() - 0.5) / 10. * 1,
        (Math.random() - 0.5) / 10. * 1,
        (Math.random() - 0.5) * 2 * 2.
    ];

    let targetTarget = 0;
    let gravity = 9.8;
    let masspole = 0.1;
    let masscart = 1.0;
    let length = 0.5;
    let total_mass = (masspole + masscart);
    let polemass_length = masspole * length;
    let force_mag = 10.0;
    let tau = 0.02;
    let x_threshold = 4;
    let theta_threshold_radians = 30 * 2 * Math.PI / 360.;

    let tanh = (x) => {
        return (Math.exp(2 * x) - 1) / ( Math.exp(2  *x) + 1);
    }

    let temperature = 2;

    let model = (obs) => {
        // obs -> 5 vector

        //janky for loop matrix multiplication
        let hiddenActivations = []
        for (let n = 0; n < 30; n++){
           let neuronAcc = 0;
            for (let i = 0; i < 5; i++){
                neuronAcc += ih_weight[n][i] * obs[i];
           } 

           neuronAcc += ih_bias[n];

           // tanh
           hiddenActivations.push(tanh(neuronAcc));
        }

        let outputActivations = [];
        for (let n = 0; n < 2; n++){
            let neuronAcc = 0;
            for (let i = 0; i < 30; i++){
                neuronAcc += ha_weight[n][i] * hiddenActivations[i];
            }

            neuronAcc += ha_bias[n];

            // sigmoid 
            outputActivations.push(Math.exp(neuronAcc * temperature));
        }

        // normalize output activations
        let sum = outputActivations.reduce((a, b) => {return a + b;}, 0)
        for (let i = 0; i < outputActivations.length; i++){
            outputActivations[i] /= sum;
        }

        return outputActivations;

    }

    let step = (state, action) => {
        x = state[0];
        x_dot = state[1];
        theta = state[2];
        theta_dot = state[3];
        target = state[4];

        if (action === 1){
            force = force_mag 
        }
        else{
            force = -force_mag
        }
        //force = 0;

        costheta = Math.cos(theta)
        sintheta = Math.sin(theta)

        temp = (force + polemass_length * theta_dot ** 2 * sintheta) / total_mass
        thetaacc = (gravity * sintheta - costheta * temp) / (length * (4.0 / 3.0 - masspole * costheta ** 2 / total_mass))
        xacc = temp - polemass_length * thetaacc * costheta / total_mass

        x = x + tau * x_dot
        x_dot = x_dot + tau * xacc
        theta = theta + tau * theta_dot
        theta_dot = theta_dot + tau * thetaacc

        state = [x, x_dot, theta, theta_dot, target]

        done = x < -x_threshold || x > x_threshold || theta < -theta_threshold_radians || theta > theta_threshold_radians;
        
        return [state, done]
    }

    let pole = document.getElementById('pole');
    //console.log('yeet');

    let getRandomInt = (min, max) => {
        min = Math.ceil(min);
        max = Math.floor(max);
        return Math.floor(Math.random() * (max - min)) + min;
    }

    setInterval( () => {
        let actionProbs = model(state);

        let action;
        if (Math.random() < actionProbs[0]){
            action = 0;
        }else{
            action = 1;
        }

        env = step(state, action);
        state = env[0];
        done = env[1];

        // move target closer to targetTarget
        state[4] = (0.94) * state[4] + 0.06 * targetTarget;

        //console.log( "rotate(" + state[0] + "rad)");
        let width = $(window).width();
        let scale = $(window).width() / 6;

        let translate = `translateX(${(state[0]) * scale + width / 2}px)`;
        pole.style.transform = translate + " rotate(" + Math.round(state[2] * 180/Math.PI) + "deg)";
        cart.style.transform = translate;

        if (Math.abs(state[0] - state[4]) < 0.2){
            cart.style.background = "darkgreen";
        }else if (Math.abs(state[0] - state[4]) < 0.5){
            cart.style.background = "gold";
        }else {
            cart.style.background= 'red';
        }

        //console.log(state[0] * 180 / Math.PI);

        if (done) {
            state = [
                (Math.random() - 0.5) * 2 * 2.,
                (Math.random() - 0.5) / 10.,
                (Math.random() - 0.5) / 10.,
                (Math.random() - 0.5) / 10.,
                (Math.random() - 0.5) * 2 * 2.
            ];
        }
    }, 1000 / 50.);
        
    
</script>
